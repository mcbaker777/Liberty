<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Liberty â€” Readiness Map v3</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-padding-top: 170px; }
body { font-family: 'IBM Plex Sans', system-ui, sans-serif; background: #f1f5f9; color: #1e293b; min-height: 100vh; overflow-x: auto; }
button { font-family: inherit; }
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: #e2e8f0; }
::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #64748b; }
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<script type="text/babel">
const { useState, useRef, useCallback, useEffect } = React;

// â”€â”€ Audio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function useAudio(audioOn) {
  const ctxRef = useRef(null);
  const getCtx = useCallback(() => {
    if (!ctxRef.current) ctxRef.current = new (window.AudioContext || window.webkitAudioContext)();
    if (ctxRef.current.state === 'suspended') ctxRef.current.resume();
    return ctxRef.current;
  }, []);
  const playHover = useCallback(() => {
    if (!audioOn) return;
    try {
      const ctx = getCtx();
      const osc = ctx.createOscillator(), gain = ctx.createGain();
      osc.connect(gain); gain.connect(ctx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(880, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(1040, ctx.currentTime + 0.06);
      gain.gain.setValueAtTime(0, ctx.currentTime);
      gain.gain.linearRampToValueAtTime(0.03, ctx.currentTime + 0.01);
      gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.09);
      osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.09);
    } catch(e) {}
  }, [audioOn, getCtx]);
  const playClick = useCallback(() => {
    if (!audioOn) return;
    try {
      const ctx = getCtx();
      const osc = ctx.createOscillator(), gain = ctx.createGain();
      osc.connect(gain); gain.connect(ctx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(520, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(320, ctx.currentTime + 0.1);
      gain.gain.setValueAtTime(0, ctx.currentTime);
      gain.gain.linearRampToValueAtTime(0.06, ctx.currentTime + 0.008);
      gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.14);
      osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.14);
    } catch(e) {}
  }, [audioOn, getCtx]);
  return { playHover, playClick };
}

// â”€â”€ Speech â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function useSpeech(audioOn) {
  const [speaking, setSpeaking] = useState(false);
  const stop = useCallback(() => { window.speechSynthesis.cancel(); setSpeaking(false); }, []);
  const speak = useCallback((text) => {
    if (!audioOn || !text) return;
    window.speechSynthesis.cancel();
    const utt = new SpeechSynthesisUtterance(text);
    utt.rate = 0.95; utt.pitch = 1.0; utt.volume = 1.0;
    const voices = window.speechSynthesis.getVoices();
    const preferred = voices.find(v => v.name.includes('Samantha') || v.name.includes('Karen') || v.name.includes('Daniel') || v.name.includes('Google US') || v.name.includes('Microsoft Aria'));
    if (preferred) utt.voice = preferred;
    utt.onstart = () => setSpeaking(true);
    utt.onend = () => setSpeaking(false);
    utt.onerror = () => setSpeaking(false);
    window.speechSynthesis.speak(utt);
  }, [audioOn]);
  useEffect(() => { if (!audioOn) stop(); }, [audioOn, stop]);
  return { speak, stop, speaking };
}

// â”€â”€ Constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PHASES_D1 = [
  { id:"target",    label:"Targeting",    dates:"Now â†’ Feb 28",   accent:"#3b82f6", arrow:"MVEE + site list must be locked before Mobilization begins" },
  { id:"mobilize",  label:"Mobilization", dates:"Mar 1 â†’ Mar 31", accent:"#8b5cf6", arrow:"Manager Cascade Pack + Single Front Door must be ready before Readiness phase" },
  { id:"readiness", label:"Readiness",    dates:"Apr 1 â†’ Apr 30", accent:"#f59e0b", arrow:"Go/No-Go brief must clear before Day-1 execution" },
  { id:"exec",      label:"âš¡ Day-1",      dates:"May 1 + 72 hrs", accent:"#ef4444" },
];
const PHASES_TSA = [
  { id:"stabilize", label:"Stabilize",  dates:"D-1 â†’ Month 2", accent:"#10b981", arrow:"Hypercare data + ticket trends must inform Enable phase priorities" },
  { id:"enable",    label:"Enable",     dates:"Month 2 â†’ 4",   accent:"#06b6d4", arrow:"SAP role mapping + power user competency must be validated before Migration" },
  { id:"migrate",   label:"Migrate",    dates:"Month 4 â†’ 6",   accent:"#2563eb", arrow:"Pre-simulation of month-end close required before SAP go-live" },
  { id:"exit",      label:"âœ“ TSA Exit", dates:"~Month 6",      accent:"#059669" },
];

const STATUS = {
  red:    { bg:"rgba(220,38,38,0.08)",   text:"#dc2626", border:"rgba(220,38,38,0.35)",   label:"Critical",  dot:"#dc2626" },
  issue:  { bg:"rgba(234,88,12,0.08)",   text:"#ea580c", border:"rgba(234,88,12,0.35)",   label:"Issue",     dot:"#ea580c" },
  amber:  { bg:"rgba(217,119,6,0.08)",   text:"#b45309", border:"rgba(217,119,6,0.3)",    label:"At Risk",   dot:"#d97706" },
  green:  { bg:"rgba(5,150,105,0.08)",   text:"#047857", border:"rgba(5,150,105,0.3)",    label:"On Track",  dot:"#059669" },
  blue:   { bg:"rgba(37,99,235,0.07)",   text:"#1d4ed8", border:"rgba(37,99,235,0.25)",   label:"Planned",   dot:"#2563eb" },
  gray:   { bg:"rgba(100,116,139,0.06)", text:"#475569", border:"rgba(100,116,139,0.2)",  label:"Deferred",  dot:"#64748b" },
};

const TASK_TYPES = {
  precondition: { icon:"ðŸ”’", label:"Pre-condition", desc:"Must complete before downstream tasks can begin", color:"#7c3aed" },
  blocked:      { icon:"â›“",  label:"Blocked",       desc:"Waiting on an external input or upstream dependency", color:"#dc2626" },
  parallel:     { icon:"â‡Œ",  label:"Parallel",      desc:"Can run simultaneously with other workstreams", color:"#2563eb" },
  handoff:      { icon:"â†’",  label:"Handoff",        desc:"Owned elsewhere â€” OCM monitors, does not deliver", color:"#64748b" },
  standard:     { icon:"",   label:"Standard",       desc:"Core OCM delivery item", color:"#334155" },
};

const LANES = [
  { id:"ocm",       label:"OCM / Comms",           accent:"#8b5cf6" },
  { id:"training",  label:"Training & Enablement",  accent:"#06b6d4" },
  { id:"identity",  label:"Identity & Access",      accent:"#ef4444" },
  { id:"workplace", label:"Workplace / Google",     accent:"#f59e0b" },
  { id:"apps",      label:"Corporate Apps",         accent:"#10b981" },
  { id:"infra",     label:"Infrastructure",         accent:"#6366f1" },
  { id:"support",   label:"Support (iCare)",        accent:"#ec4899" },
  { id:"hr",        label:"HR / People & Org",      accent:"#f97316" },
];

// â”€â”€ Dependency Chains â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEPENDENCY_CHAINS = [
  {
    id:"site-list",
    title:"Validated Site List",
    blocker:"No validated site list with CE headcounts received from Deloitte/Marine",
    owner:"Deloitte / Marine Reulier",
    urgency:"red",
    blocks:[
      { lane:"support", label:"Heat Zone Tiering (88 sites)" },
      { lane:"support", label:"Mousepad Procurement" },
      { lane:"workplace", label:"ðŸš¨ Chromebook Procurement" },
      { lane:"support", label:"Recruit Volunteer Army (50)" },
    ]
  },
  {
    id:"analytical-structure",
    title:"SAP Analytical Structure",
    blocker:"Company codes, cost centers, profit centers, WBSEs not yet built in SAP. Not visible in any Smartsheet finance workstream task.",
    owner:"Finance Workstream (Ann Ferrizzi flagged gap â€” ownership unassigned)",
    urgency:"red",
    blocks:[
      { lane:"hr", label:"Employee-to-cost-center mapping" },
      { lane:"apps", label:"DOAs + System Access Provisioning" },
      { lane:"apps", label:"Ariba/Concur Trainer Kickoff" },
      { lane:"training", label:"SAP Power User Bootcamp" },
    ]
  },
  {
    id:"mvee",
    title:"MVEE Definition Sign-Off",
    blocker:"Binary Day-1 success criteria not yet signed off by Paul Watkeys / Marc Demougeot",
    owner:"OCM Lead â†’ Paul Watkeys / Marc Demougeot",
    urgency:"amber",
    blocks:[
      { lane:"support", label:"IVR Configuration" },
      { lane:"training", label:"Day-1 Survival Kit" },
      { lane:"support", label:"Single Front Door Portal" },
      { lane:"training", label:"War Room Bootcamp" },
    ]
  },
  {
    id:"workday-ownership",
    title:"Workday Training Ownership",
    blocker:"Written confirmation from Cecilia Cheradame that HR owns Workday training end-to-end not yet received",
    owner:"Cecilia Cheradame / HR Workstream",
    urgency:"amber",
    blocks:[
      { lane:"apps", label:"Workday Ownership Confirm" },
      { lane:"hr", label:"Workday: tHRive Curriculum" },
      { lane:"training", label:"TSA Training Roadmap" },
    ]
  },
  {
    id:"sap-day1-scope",
    title:"SAP Day-1 vs. TSA Scope Decision",
    blocker:"Must confirm with Vamsi Dongre: SAP on Legal Day-1 (April) or TSA Exit (October). An April decision collapses training window to 8 weeks.",
    owner:"Vamsi Dongre / Corporate Apps",
    urgency:"amber",
    blocks:[
      { lane:"apps", label:"âš  Day-1 vs. TSA Scope" },
      { lane:"apps", label:"SAP Role Mapping (Day-2+)" },
      { lane:"training", label:"SAP Power User Bootcamp" },
      { lane:"apps", label:"âš  Month-End Close in SAP" },
    ]
  },
  {
    id:"ce-user-lists",
    title:"Clean Earth User Lists",
    blocker:"No CE employee data accessible pre-close. Blocks training volume estimates across all apps. Requesters, approvers, DOA holders all unknown.",
    owner:"Deloitte clean-room / post-close discovery",
    urgency:"amber",
    blocks:[
      { lane:"apps", label:"Ariba/Concur Trainer Kickoff" },
      { lane:"apps", label:"Workday Ownership Confirm" },
      { lane:"training", label:"CIA Training Scope Map" },
      { lane:"support", label:"Heat Zone Tiering (88 sites)" },
    ]
  },
  {
    id:"salesforce-new-org",
    title:"Salesforce New Org Timeline",
    blocker:"New Org development targeting May 1 â€” already at risk of slipping per Ken Higgins / Jamie McCann. Not yet formally flagged as a program risk.",
    owner:"Ken Higgins / Jamie McCann / Murphy's team",
    urgency:"amber",
    blocks:[
      { lane:"apps", label:"Salesforce New Org Training" },
      { lane:"apps", label:"CE Salesforce Team Onboarding" },
    ]
  },
];

// â”€â”€ Task Data D1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TASKS_D1 = {
  ocm:{
    target:[
      { label:"âœ“ Day-1 Date Confirmed", status:"green", type:"standard",
        detail:"Day-1 confirmed as May 1, 2026. All procurement, printing, and staffing timelines anchored to this date. Verify all workstream leads have updated their plans accordingly.",
        voiceover:"Day 1 is confirmed for May 1st, 2026. This is the anchor date for every downstream dependency in the integration. Every workstream lead should now have this date locked." },
      { label:"Lock MVEE Definition", status:"amber", type:"precondition", depChain:"mvee",
        detail:"Define binary Day-1 success: Can I log in? Can I reach my apps? Do I know who to call? Get Paul/Marc sign-off. BLOCKS: IVR config, Survival Kit, Single Front Door, War Room Bootcamp.",
        voiceover:"The MVEE defines what Day 1 success actually means. Three binary questions: Can I log in? Can I reach my Day 1 applications? Do I know who to call? Sign-off from Paul and Marc is critical to prevent scope creep." },
    ],
    mobilize:[
      { label:"Manager Cascade Pack", status:"blue", type:"standard",
        detail:"Scripted talking points for site managers. Core message: 'This change is permanent.' Counters the Suez middle-manager pocket veto. Due 2 weeks before close.",
        voiceover:null },
      { label:"Integration Narrative", status:"blue", type:"standard",
        detail:"Draft the Change Story â€” the strategic why behind the integration. Aligns once Cecilia locks the Day-1 Target Operating Model.",
        voiceover:null },
    ],
    readiness:[
      { label:"Suez Leadership Deck", status:"amber", type:"standard",
        detail:"7 Suez lessons â†’ concrete leadership actions for Marc. Each slide = one decision required. In progress.",
        voiceover:"The Suez Leadership Deck translates seven key lessons from the Suez integration into concrete decisions Marc needs to make before Day 1. This is a forward-looking decision brief, not a retrospective." },
      { label:"Go/No-Go Brief", status:"blue", type:"precondition",
        detail:"Evidence-based SteerCo brief: CIA completion %, MVEE checklist, Heat Map color, War Room staffed Y/N. GATE: This brief must clear before Day-1 execution is authorized.",
        voiceover:null },
    ],
    exec:[
      { label:"2Ã— Daily Pulse Checks", status:"amber", type:"standard",
        detail:"8AM / 4PM stand-ups in Command Center. OCM updates Single Front Door FAQ in real-time based on top 3 ticket types.",
        voiceover:"During Day 1, two stand-ups daily in the Command Center at 8 AM and 4 PM. Identify the top three emerging issues and update the FAQ in real time. This prevents small problems from becoming rumors." },
      { label:"Rumor Control Active", status:"blue", type:"standard",
        detail:"Monitor for 'wait it out' behavior. Deploy manager cascade reinforcement if field resistance spikes.",
        voiceover:null },
    ],
  },
  training:{
    target:[
      { label:"CIA Training Scope Map", status:"green", type:"standard",
        detail:"Completed. Each CIA entry mapped to modality: self-service QRG, virtual, or in-person. Priority: Google WS (all users), MFA (all users), SAP/Ariba (Finance/Procurement). Matt Baker functioning as Training Coordinator.",
        voiceover:null },
    ],
    mobilize:[
      { label:"KoP Hub Setup", status:"blue", type:"parallel",
        detail:"Secure King of Prussia training room for 100+ users. Reserve 50 Chromebooks from TracyAnn bulk order. Hotel conference room as contingency.",
        voiceover:null },
      { label:"Google WS Curriculum", status:"blue", type:"parallel",
        detail:"Coordinate with Heather Summers + 4 external Google Partner trainers. Validate SOW includes Day-1 floor-walking, not just classroom instruction.",
        voiceover:null },
      { label:"Day-1 Survival Kit", status:"blue", type:"blocked", depChain:"mvee",
        detail:"1-page printable: MFA steps, Gmail login, iCare number, QR code. BLOCKED ON: MVEE sign-off. Must work for both digital and non-digital field users.",
        voiceover:null },
    ],
    readiness:[
      { label:"Login Cheat Sheet (3-pwd)", status:"blue", type:"standard",
        detail:"3-password confusion guide: Legacy Laptop â†’ Entra ID â†’ Gmail. Incorporated into Day-1 Survival Kit. Must be tested by non-IT users before print.",
        voiceover:null },
      { label:"War Room Bootcamp", status:"blue", type:"blocked", depChain:"mvee",
        detail:"2-hour training for 50 volunteer Champions. Covers MFA flow, Gmail login, iCare escalation path. BLOCKED ON: MVEE sign-off + volunteer recruitment.",
        voiceover:null },
    ],
    exec:[
      { label:"Live Training at KoP + Sites", status:"green", type:"standard",
        detail:"Physical presence at King of Prussia confirmed. Matt + Emily + Sophia on-site. Google Partner trainers running virtual tracks simultaneously.",
        voiceover:null },
    ],
  },
  identity:{
    target:[
      { label:"CIA Cyber Capacity", status:"issue", type:"standard",
        detail:"Validated 2/6 with Taylor Paich: Day-1 is Assessment, not Enforcement. Do NOT strip admin rights Day-1. ACTIVE ISSUE: 25% Cyber workload increase with zero new headcount â€” present capacity deficit, not a future risk.",
        voiceover:"Cybersecurity posture for Day 1 validated with Taylor Paich. Confirmed approach: Assessment, not Enforcement. Admin rights will not be stripped on Day 1. However, the Cyber team is absorbing a 25% workload increase with zero new headcount â€” a real bottleneck risk." },
    ],
    mobilize:[
      { label:"Provisioning Plan (2,500)", status:"blue", type:"precondition",
        detail:"Define provisioning schedule for CE users into Veolia Okta/Entra ID. Priority: Day-1 critical roles first â€” Finance leads, Site Managers, IT staff. PRECONDITION for all app training.",
        voiceover:null },
      { label:"MFA Enrollment Strategy", status:"blue", type:"standard",
        detail:"Self-serve vs. IT pre-enroll decision. Manager Password Handover model as zero-IT-literacy fallback.",
        voiceover:null },
    ],
    readiness:[
      { label:"Merger Phishing Training", status:"blue", type:"standard",
        detail:"Mandatory pre-close module: M&A-specific phishing threats. Migrates to Riot platform from legacy Enviri tooling.",
        voiceover:null },
      { label:"Endpoint Agent Deploy", status:"blue", type:"standard",
        detail:"Install Veolia EDR agents on CE devices â€” Assessment only, no policy enforcement yet.",
        voiceover:null },
    ],
    exec:[
      { label:"Identity Embed in War Room", status:"blue", type:"standard",
        detail:"Cyber team member embedded in Command Center. Direct line to Cyber if user cannot authenticate.",
        voiceover:null },
    ],
  },
  workplace:{
    target:[
      { label:"ðŸš¨ Chromebook Procurement", status:"red", type:"blocked", depChain:"site-list",
        detail:"100 Chromebook bulk order in progress; 50 ring-fenced for KoP. BLOCKED ON: Validated site list. Cannot finalize distribution until headcounts confirmed per site.",
        voiceover:"Chromebook procurement is blocked. 100 units on order, 50 reserved for KoP, but distribution planning cannot proceed without the validated site list." },
      { label:"CIA Workplace: Google Shock", status:"amber", type:"standard",
        detail:"CE is full Microsoft 365. Google Shock confirmed 2/11. Users get @veolia.com email Day-1. Auto-forwarding from legacy addresses must be validated. Suez lesson: roadshows alone didn't prevent last-minute panic.",
        voiceover:"Clean Earth is a fully Microsoft 365 organization moving to Google Workspace on Day 1. This is a Google Shock scenario. Every CE employee gets a new Veolia email address. Auto-forwarding must be validated before close." },
    ],
    mobilize:[
      { label:"Mousepad Procurement", status:"blue", type:"blocked", depChain:"site-list",
        detail:"Printed mousepads with iCare number for every CE user. 30-day lead time. BLOCKED ON: Validated site list for distribution quantities.",
        voiceover:null },
      { label:"Self-Service Kiosk Design", status:"blue", type:"handoff",
        detail:"TracyAnn Neary designing kiosk solution for sites without physical training presence. OCM monitors; Workplace owns delivery.",
        voiceover:null },
    ],
    readiness:[
      { label:"Device Readiness Test", status:"blue", type:"standard",
        detail:"Validate Day-1 device experience end-to-end: Chromebook imaging, legacy laptop status, Intune enrollment.",
        voiceover:null },
    ],
    exec:[
      { label:"Fleet & Kiosks LIVE", status:"green", type:"standard",
        detail:"Training fleet deployed at KoP and hub sites. All devices tested with Day-1 login flow.",
        voiceover:null },
    ],
  },
  apps:{
    target:[
      { label:"âš  SAP Day-1 vs. TSA Scope", status:"issue", type:"precondition", depChain:"sap-day1-scope",
        detail:"ACTIVE ISSUE: Decision not yet made. Window is already compressing â€” if SAP goes live on Legal Day-1 (April), training window collapses to 8 weeks. Must confirm with Vamsi Dongre immediately. PRECONDITION for all Corporate Apps planning.",
        voiceover:"SAP scope question has direct training timeline implications. If SAP goes live on Legal Day 1 in April, the training window collapses from six months to eight weeks. We cannot finalize the Corporate Apps training plan until this decision is made." },
      { label:"App Owner Outreach", status:"blue", type:"standard",
        detail:"Emails sent to Vamsi Dongre, Cindy Solomon, Stephanie Grubis, Brett and Karen, and Jeff.",
        voiceover:null },
      { label:"ðŸš¨ Analytical Structure Gap", status:"red", type:"precondition", depChain:"analytical-structure",
        detail:"CRITICAL: Company codes, cost centers, profit centers, WBSEs must be built in SAP before ANY downstream activity. Gap confirmed by Ann Ferrizzi 2/13: not visible in any Smartsheet finance workstream task. Ownership unassigned. BLOCKS: DOAs, system access, all Ariba/Concur training.",
        voiceover:"This is the most overlooked critical dependency in the integration. Ann Ferrizzi confirmed on February 13th that the SAP analytical structure â€” company codes, cost centers, profit centers â€” is not assigned to any owner and does not appear in any Smartsheet task. Without this, no downstream finance or procurement activity can proceed." },
    ],
    mobilize:[
      { label:"Ariba/Concur Trainer Kickoff", status:"blue", type:"blocked", depChain:"ce-user-lists",
        detail:"Kickoff in progress. BLOCKED ON: CE user list (requesters, approvers, DOA holders unknown). Cindy Solomon + Ann Ferrizzi leading. Roadshow model recommended for 90+ sites â€” on-site preferred over remote-only per Ann's lessons learned.",
        voiceover:null },
      { label:"Workday Ownership Confirm", status:"issue", type:"precondition", depChain:"workday-ownership",
        detail:"ACTIVE ISSUE: Email sent to Cecilia with EOW deadline â€” no written confirmation received. HR ownership of Workday training (content, logistics, delivery) is unresolved. If not confirmed, DB&T budget must include Workday training placeholder immediately.",
        voiceover:"Waiting on written confirmation from Cecilia that HR owns Workday training end to end. Until confirmed, there is a budget and accountability gap." },
    ],
    readiness:[
      { label:"SAP Role Mapping (Day-2+)", status:"gray", type:"blocked", depChain:"analytical-structure",
        detail:"Map CE finance/procurement roles to Veolia SAP T-Codes. BLOCKED ON: Analytical structure completion. Cannot train until role mapping complete.",
        voiceover:null },
      { label:"Concur Mobile Guide", status:"gray", type:"standard",
        detail:"Self-service QRG for Concur mobile app setup. Cindy Solomon owns Concur end-to-end.",
        voiceover:null },
    ],
    exec:[
      { label:"Day-1 App Access Live", status:"gray", type:"handoff",
        detail:"Confirm Concur, Ariba view-only, and Day-1 corporate app access provisioned before 8AM Day-1. Owned by app teams; OCM confirms via MVEE checklist.",
        voiceover:null },
    ],
  },
  infra:{
    target:[
      { label:"CIA Infra: No Day-1 Impacts", status:"green", type:"standard",
        detail:"Validated 2/18 with Elena Navarette. No infrastructure changes are Day-1 critical for CE users. VPN, SD-WAN, file server all TSA-window activities. Oracle ERP surfaced as cross-stream item.",
        voiceover:null },
    ],
    mobilize:[
      { label:"âš  Tech Liaison Appointment", status:"amber", type:"handoff",
        detail:"Suez lesson: dedicated Infrastructure/Security liaison to partner with CE IT lead through TSA. Not something OCM can own â€” must be assigned by technical leadership. Currently unassigned.",
        voiceover:"One of the clearest lessons from Suez is that the absence of a dedicated technical liaison created significant friction. A named Infrastructure and Security liaison must be assigned by technical leadership. Currently unassigned." },
      { label:"Network Bridge Validation", status:"blue", type:"standard",
        detail:"Confirm CE-Veolia network connectivity. FoxPro and 4D legacy apps must remain accessible during TSA.",
        voiceover:null },
    ],
    readiness:[
      { label:"Remote Access Testing", status:"blue", type:"standard",
        detail:"End-to-end test: CE user, legacy laptop, new Veolia VPN. Identify sites requiring manual intervention.",
        voiceover:null },
    ],
    exec:[
      { label:"Network Bridge LIVE", status:"green", type:"standard",
        detail:"CE-Veolia bridge active. Legacy applications accessible via new Veolia credentials.",
        voiceover:null },
    ],
  },
  support:{
    target:[
      { label:"ðŸš¨ Validated Site List", status:"red", type:"blocked", depChain:"site-list",
        detail:"CRITICAL BLOCKER: No validated site list with headcounts. Blocks: mousepad ordering, Welcome Committee targeting, Heat Zone tiering, War Room routing. Must come from Deloitte / Marine Reulier.",
        voiceover:"The validated site list is the single most consequential open dependency in the entire Day 1 plan. Without it, four separate workstreams are blocked: mousepad procurement, Welcome Committee deployment, Heat Zone tiering, and War Room routing." },
      { label:"Ed Cacho Meeting (iCare)", status:"issue", type:"standard",
        detail:"Define: persistent Google Meet bridge structure, IVR dedicated CE queue, rapid pulse every 2hrs. ACTIVE ISSUE: iCare is currently -40% staffed â€” this is a present deficit. Day-1 load must be actively managed to avoid service desk collapse.",
        voiceover:"Three decisions outstanding with Ed Cacho: the Google Meet bridge structure, the dedicated CE IVR queue, and the 2-hour pulse cadence. iCare is running at 60% normal capacity â€” Day 1 load must be carefully managed." },
    ],
    mobilize:[
      { label:"Recruit Volunteer Army (50)", status:"blue", type:"blocked", depChain:"site-list",
        detail:"Recruit Google Champions to staff Day-1 Virtual Bridge. 2-hour Bootcamp required. BLOCKED ON: Validated site list for geographic routing assignments.",
        voiceover:null },
      { label:"Single Front Door Portal", status:"blue", type:"blocked", depChain:"mvee",
        detail:"Stand up dedicated URL: MFA Setup, Gmail Access, Get Help, FAQ. BLOCKED ON: MVEE sign-off to confirm content scope.",
        voiceover:null },
    ],
    readiness:[
      { label:"IVR Configuration", status:"blue", type:"blocked", depChain:"mvee",
        detail:"Configure iCare IVR: dedicated Clean Earth Day-1 option. BLOCKED ON: MVEE definition to confirm routing logic.",
        voiceover:null },
      { label:"Heat Zone Tiering (88 sites)", status:"blue", type:"blocked", depChain:"site-list",
        detail:"T1 (50+ staff): Welcome Committee. T2 (10â€“50): Manager Box. T3 (<10): Digital + wallet cards. BLOCKED ON: Validated site list.",
        voiceover:null },
    ],
    exec:[
      { label:"âš¡ Command Center 48hr Live", status:"amber", type:"standard",
        detail:"Persistent Google Meet bridge, 48 continuous hours. 50 volunteers + Cyber embed + OCM Lead. Escalation: L0 Portal â†’ L1 Bridge â†’ L2 iCare â†’ L3 WS Lead. Pulse every 2hrs.",
        voiceover:"The Command Center runs as a persistent Google Meet bridge for 48 continuous hours from close. 50 volunteer Power Users embedded with the Cyber team rep and OCM lead. Escalation runs from the self-service portal at Level 0 through the bridge at Level 1, to iCare at Level 2, to the workstream lead at Level 3." },
    ],
  },
  hr:{
    target:[
      { label:"Workday Ownership Pending", status:"amber", type:"precondition", depChain:"workday-ownership",
        detail:"Email sent to Cecilia: HR owns Workday content, logistics, and delivery. Awaiting written confirmation. If not received by EOW, DB&T budget must include placeholder.",
        voiceover:"HR ownership of the Workday training program is pending written confirmation. If not received by end of week, the DB&T budget will need a placeholder to avoid a coverage gap." },
      { label:"Critical Talent Retention", status:"blue", type:"handoff",
        detail:"FoxPro and 4D SMEs are flight risks per Due Diligence. OCM feeds specific IT names to Cecilia's retention list. HR owns retention packages.",
        voiceover:null },
    ],
    mobilize:[
      { label:"Day-1 Org Chart Lock", status:"blue", type:"precondition",
        detail:"Cecilia owns the Day-1 Target Operating Model. OCM needs this locked to build the Change Story. PRECONDITION for manager cascade content.",
        voiceover:null },
      { label:"Welcome Packet (HR + IT)", status:"blue", type:"parallel",
        detail:"OCM requests insertion of Day-1 Digital Essentials 1-pager into HR Welcome Packet.",
        voiceover:null },
    ],
    readiness:[
      { label:"Manager Script Delivery", status:"blue", type:"parallel",
        detail:"HR and OCM co-deliver 'This is Permanent' script to site managers 1 week before close.",
        voiceover:null },
    ],
    exec:[
      { label:"HR Support Active", status:"green", type:"handoff",
        detail:"Bill Agostini and Lauren deployed in parallel with IT Command Center. OCM monitors; HR owns.",
        voiceover:null },
    ],
  },
};

// â”€â”€ Task Data TSA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TASKS_TSA = {
  ocm:{
    stabilize:[{ label:"Hypercare Dashboard", status:"amber", type:"standard",
      detail:"Live readiness dashboard: ticket volume, adoption %, open RAID items. Updated daily during Hypercare.",
      voiceover:"The Hypercare Dashboard is the primary situational awareness tool for the 30 days post Day 1. Tracks ticket volume, adoption percentages, and open RAID items daily." }],
    enable:[
      { label:"TSA Exit Change Story", status:"blue", type:"standard", detail:"Narrative: why SAP and Workday adoption matters for TSA Exit.", voiceover:null },
      { label:"Culture Integration Pulse", status:"blue", type:"standard", detail:"5-question pulse survey at Month 2.", voiceover:null },
    ],
    migrate:[{ label:"Cutover Comms Package", status:"blue", type:"standard", detail:"What changes, when, who to call. Distributed 2 weeks before SAP cutover.", voiceover:null }],
    exit:[{ label:"BAU Handoff + Close-Out", status:"green", type:"standard", detail:"OCM formally hands off to operational management. Lessons learned documented.", voiceover:null }],
  },
  training:{
    stabilize:[
      { label:"Google WS Phase 2", status:"amber", type:"standard",
        detail:"Advanced Google Workspace: Drive collaboration, Meet, Calendar sharing.",
        voiceover:"Google Workspace Phase 2 builds on Day 1 survival training to develop genuine proficiency. Focus shifts from basic login to collaborative features: shared Drive, Meet, Calendar integration." },
      { label:"Competency Baseline Survey", status:"blue", type:"standard", detail:"Measure post-Day-1 proficiency by user segment.", voiceover:null },
    ],
    enable:[
      { label:"SAP Power User Bootcamp", status:"blue", type:"blocked", depChain:"analytical-structure",
        detail:"Role-based SAP training. BLOCKED ON: Analytical structure completion + SAP role mapping + sandbox with CE data. Cindy Solomon's train-the-trainer model recommended for scale.",
        voiceover:null },
      { label:"Ariba Roadshow (On-Site)", status:"blue", type:"blocked", depChain:"ce-user-lists",
        detail:"Ann Ferrizzi lesson learned: remote-only = repeat training cycles. Recommendation: regional hotel sessions, 30â€“50 users, hands-on live PO entry. BLOCKED ON: CE user list + DOA structure.",
        voiceover:null },
      { label:"TSA Training Roadmap", status:"blue", type:"blocked", depChain:"workday-ownership",
        detail:"Full training calendar for Month 2â€“6. BLOCKED ON: Workday ownership confirmation + SAP scope decision.",
        voiceover:null },
    ],
    migrate:[
      { label:"CE Ops App Training (CORE/ORBIT)", status:"amber", type:"precondition",
        detail:"CRITICAL RISK (Ken Higgins 2/13): Veolia teams must be trained on CE operational platforms CORE and ORBIT. CE may lack training documentation. Dependency on CE's training capacity â€” not yet assessed.",
        voiceover:"This is the inverse training risk. Ken Higgins flagged that Veolia's teams need to learn Clean Earth's operational applications â€” CORE and ORBIT. We are dependent on Clean Earth having adequate training documentation and capacity. This has not yet been assessed and represents a significant unknown." },
      { label:"Dataserv User Onboarding", status:"blue", type:"blocked", depChain:"ce-user-lists",
        detail:"Joaquin + Jason (AP supervisor) own Dataserv training. Materials refreshed from recent acquisitions. BLOCKED ON: CE invoice reviewer and approver list + DOA limits from Grant Thornton.",
        voiceover:null },
    ],
    exit:[{ label:"Training ROI Assessment", status:"green", type:"standard", detail:"Measure training effectiveness vs. ticket volume reduction and SAP adoption rate.", voiceover:null }],
  },
  identity:{
    stabilize:[{ label:"Legacy System Inventory", status:"blue", type:"standard", detail:"Full inventory of FoxPro and 4D systems. Map to SME owners.", voiceover:null }],
    enable:[
      { label:"FoxPro/4D Knowledge Transfer", status:"blue", type:"precondition", detail:"Structured KT sessions with CE legacy SMEs before role transitions. PRECONDITION for legacy decommission.", voiceover:null },
      { label:"Azure/AWS Architecture Align", status:"blue", type:"handoff", detail:"Backend infrastructure alignment with Len De La Cruz. EA owns; OCM monitors for user impact.", voiceover:null },
    ],
    migrate:[{ label:"Legacy Decommission Planning", status:"blue", type:"standard", detail:"Define sunset timeline for CE legacy infrastructure.", voiceover:null }],
    exit:[{ label:"Infra on Veolia Stack âœ“", status:"green", type:"standard", detail:"All CE infrastructure migrated to Veolia standard environments.", voiceover:null }],
  },
  workplace:{
    stabilize:[{ label:"VPN Migration (AnyConnectâ†’Netskope)", status:"blue", type:"standard", detail:"CE remote workers migrate to Veolia standard VPN/ZTNA. Offshore resources included. Elena Navarette leading.", voiceover:null }],
    enable:[
      { label:"140TB File Server Carve-Out", status:"blue", type:"precondition", detail:"Migrate CE files from shared Enviri/CE on-prem server. PII review required. Compliance implications. Elena Navarette: placeholder in CIA â€” details TBD post-discovery.", voiceover:null },
      { label:"SD-WAN Migration Planning", status:"issue", type:"standard", detail:"ACTIVE ISSUE: Ed/Marc want all 88 sites migrated within TSA window â€” Elena's team is pushing back on feasibility. Active scope conflict not yet resolved. Jasprit's existing process must scale to CE sites; timeline negotiation ongoing.", voiceover:null },
    ],
    migrate:[{ label:"Meraki Phase-Out Comms", status:"blue", type:"standard", detail:"Notify CE IT/network staff of dashboard transition to Veolia NOC tools.", voiceover:null }],
    exit:[{ label:"Workplace on Veolia Stack âœ“", status:"green", type:"standard", detail:"All CE workplace and connectivity infrastructure on Veolia standard.", voiceover:null }],
  },
  apps:{
    stabilize:[
      { label:"Salesforce: Current vs. New Org", status:"amber", type:"precondition", depChain:"salesforce-new-org",
        detail:"CE has 3 Salesforce orgs of unknown maturity. New Org targeting May 1 â€” already at risk. Front-end (CRM users) and back-end (CE Salesforce team) are distinct training populations. Ken Higgins / Jamie McCann own.",
        voiceover:null },
    ],
    enable:[
      { label:"CE Salesforce Team Onboarding", status:"blue", type:"blocked", depChain:"salesforce-new-org",
        detail:"Hub-and-spoke model: train CE's Salesforce team on Veolia's org config â†’ they cascade to their users. BLOCKED ON: New Org completion. Keiko (new product owner) is a training asset.",
        voiceover:null },
      { label:"Oracle ERP Wind-Down Comms", status:"blue", type:"standard", detail:"CE currently on Oracle EBS (OCI shared with Enviri). Migration to Veolia target ERP required. Finance, billing, AR/AP impacted. Dual-reporting period expected.", voiceover:null },
    ],
    migrate:[
      { label:"âš  Month-End Close in SAP", status:"amber", type:"precondition",
        detail:"First month-end close in SAP is the highest-risk event. Claude Scher flagged as critical failure point. Pre-simulation with CE data is mandatory before go-live.",
        voiceover:"The first month-end close in SAP is the single highest-risk event in the Corporate Applications workstream. A full pre-simulation using CE data is mandatory before the go-live date." },
      { label:"Cutover Freeze Comms", status:"blue", type:"standard", detail:"Communicate blackout period before SAP go-live.", voiceover:null },
    ],
    exit:[{ label:"SAP Go-Live + TSA Exit âœ“", status:"green", type:"standard", detail:"CE Finance fully transacting in SAP S/4HANA.", voiceover:null }],
  },
  infra:{
    stabilize:[{ label:"Legacy App Connectivity Audit", status:"blue", type:"standard", detail:"Confirm FoxPro/4D accessible via new Veolia credentials. Validate no TSA gaps.", voiceover:null }],
    enable:[
      { label:"FoxPro/4D SME KT Sessions", status:"blue", type:"precondition", detail:"Structured knowledge transfer before SME role transitions. Flight risk population per Due Diligence.", voiceover:null },
    ],
    migrate:[{ label:"Legacy Decommission Schedule", status:"blue", type:"standard", detail:"Define sunset dates for FoxPro, 4D, and CE legacy infrastructure per IT Contracts / Robert Litwa.", voiceover:null }],
    exit:[{ label:"Infra Fully on Veolia Stack âœ“", status:"green", type:"standard", detail:"All CE infrastructure migrated.", voiceover:null }],
  },
  support:{
    stabilize:[{ label:"Hypercare Period (30 days)", status:"amber", type:"standard",
      detail:"Extended support posture: Command Center scales from 48hr to business hours. Ticket volume monitored daily. FAQ updated in real time.",
      voiceover:"Hypercare extends elevated support for 30 days post Day 1. The Command Center scales back to business hours but monitoring intensity remains high." }],
    enable:[
      { label:"Transition to Standard iCare", status:"blue", type:"handoff", detail:"CE users fully routed to standard iCare processes. Ed Cacho owns; OCM monitors adoption.", voiceover:null },
      { label:"Ticket Trend Analysis", status:"blue", type:"standard", detail:"OCM reviews ticket categories to identify persistent training gaps.", voiceover:null },
    ],
    migrate:[{ label:"FAQ Portal TSA Phase Update", status:"blue", type:"standard", detail:"Single Front Door updated with TSA-phase content.", voiceover:null }],
    exit:[{ label:"CE Support Fully BAU âœ“", status:"green", type:"standard", detail:"CE employees indistinguishable from Veolia BAU users in iCare.", voiceover:null }],
  },
  hr:{
    stabilize:[{ label:"Post-D1 Org Comms", status:"blue", type:"handoff", detail:"HR communicates org structure changes post-close. OCM monitors for confusion signals.", voiceover:null }],
    enable:[
      { label:"Role Harmonization", status:"blue", type:"handoff", detail:"CE job titles and grades mapped to Veolia equivalents. HR owns; OCM monitors for resistance signals.", voiceover:null },
      { label:"Culture Integration Survey", status:"blue", type:"standard", detail:"Month 3 pulse: belonging, clarity of expectations, confidence in tools.", voiceover:null },
      { label:"Workday: tHRive Curriculum", status:"blue", type:"blocked", depChain:"workday-ownership",
        detail:"HR-owned Workday training curriculum. BLOCKED ON: Cecilia confirmation of ownership. If not confirmed, placeholder in DB&T budget required.", voiceover:null },
    ],
    migrate:[{ label:"Performance Cycle Alignment", status:"blue", type:"standard", detail:"CE employees onboarded to Veolia performance management cycle in Workday.", voiceover:null }],
    exit:[{ label:"HR Processes on Workday âœ“", status:"green", type:"standard", detail:"All CE HR processes fully operational in Workday.", voiceover:null }],
  },
};

// â”€â”€ Legend Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function LegendModal({ onClose, playClick }) {
  return (
    <div style={{ position:"fixed", inset:0, zIndex:1000, background:"rgba(15,23,42,0.45)", display:"flex", alignItems:"center", justifyContent:"center", padding:24 }}
      onClick={e => { if (e.target === e.currentTarget) { playClick(); onClose(); } }}>
      <div style={{ background:"#ffffff", border:"1px solid #e2e8f0", borderRadius:12, maxWidth:720, width:"100%", maxHeight:"85vh", overflowY:"auto", padding:32, boxShadow:"0 20px 60px rgba(0,0,0,0.15)" }}>
        <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center", marginBottom:24 }}>
          <div style={{ fontSize:18, fontWeight:700, color:"#1e293b", fontFamily:"'IBM Plex Mono',monospace" }}>How to Use This Map</div>
          <button onClick={() => { playClick(); onClose(); }} style={{ background:"#f1f5f9", border:"1px solid #e2e8f0", borderRadius:6, color:"#64748b", padding:"4px 12px", cursor:"pointer", fontSize:12 }}>Close âœ•</button>
        </div>

        <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:16 }}>
          {/* Purpose */}
          <div style={{ gridColumn:"1/-1", background:"rgba(99,102,241,0.05)", border:"1px solid rgba(99,102,241,0.18)", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#6366f1", marginBottom:8, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>PURPOSE</div>
            <div style={{ fontSize:13, color:"#475569", lineHeight:1.7 }}>
              This map visualizes readiness status, dependency chains, and sequencing requirements for the Project Liberty (Clean Earth) integration. It serves three audiences: <strong style={{color:"#1e293b"}}>IMO / Bain</strong> (program-level risk visibility), <strong style={{color:"#1e293b"}}>Workstream Leads</strong> (dependency awareness and sequencing), and <strong style={{color:"#1e293b"}}>OCM Team</strong> (task tracking and escalation triggers).
            </div>
          </div>

          {/* Views */}
          <div style={{ background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:10, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>TWO VIEWS</div>
            {[
              { label:"âš¡ Day-1 Readiness", sub:"Now â†’ May 1, 2026", desc:"Four phases: Targeting, Mobilization, Readiness, Day-1. Focus on MVEE and business continuity." },
              { label:"ðŸ“‹ TSA Exit Plan", sub:"May â†’ October 2026", desc:"Stabilize, Enable, Migrate, TSA Exit. Focus on competency transfer and synergy realization." },
            ].map(v => (
              <div key={v.label} style={{ marginBottom:10, paddingBottom:10, borderBottom:"1px solid #f1f5f9" }}>
                <div style={{ fontSize:12, fontWeight:600, color:"#1e293b" }}>{v.label} <span style={{ fontSize:11, color:"#94a3b8" }}>â€” {v.sub}</span></div>
                <div style={{ fontSize:11, color:"#64748b", marginTop:3 }}>{v.desc}</div>
              </div>
            ))}
          </div>

          {/* Status */}
          <div style={{ background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:10, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>STATUS COLORS</div>
            {Object.entries(STATUS).map(([k,v]) => (
              <div key={k} style={{ display:"flex", alignItems:"flex-start", gap:9, marginBottom:7 }}>
                <div style={{ width:9, height:9, borderRadius:2, background:v.dot, flexShrink:0, marginTop:3 }}/>
                <div>
                  <span style={{ fontSize:12, color:v.text, fontWeight:700 }}>{v.label}</span>
                  <span style={{ fontSize:11, color:"#94a3b8", marginLeft:6 }}>
                    {k==="red"?"Immediate action required":k==="issue"?"Problem currently occurring":k==="amber"?"Risk of failure â€” monitor":k==="green"?"Proceeding as planned":k==="blue"?"Scheduled, not yet started":"Deferred / low priority"}
                  </span>
                </div>
              </div>
            ))}
          </div>

          {/* Task types */}
          <div style={{ gridColumn:"1/-1", background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:10, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>TASK TYPE INDICATORS</div>
            <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:10 }}>
              {Object.entries(TASK_TYPES).filter(([k]) => k !== "standard").map(([k,v]) => (
                <div key={k} style={{ display:"flex", alignItems:"flex-start", gap:9 }}>
                  <span style={{ fontSize:13, flexShrink:0, marginTop:1 }}>{v.icon}</span>
                  <div>
                    <span style={{ fontSize:12, color:v.color, fontWeight:700 }}>{v.label}</span>
                    <div style={{ fontSize:11, color:"#94a3b8", marginTop:2 }}>{v.desc}</div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Phase gates */}
          <div style={{ background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:8, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>PHASE GATE ARROWS â€º</div>
            <div style={{ fontSize:12, color:"#64748b", lineHeight:1.7 }}>The <strong style={{color:"#1e293b"}}>â€º</strong> circle between phase columns is a <strong style={{color:"#1e293b"}}>gate condition</strong> â€” hover it to read what must be true before the next phase begins.</div>
          </div>

          {/* Dependencies */}
          <div style={{ background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:8, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>DEPENDENCIES PANEL</div>
            <div style={{ fontSize:12, color:"#64748b", lineHeight:1.7 }}>Click the <strong style={{color:"#1e293b"}}>Dependencies</strong> sidebar tab to see all active dependency chains. Click a chain to highlight its affected tasks across the grid in indigo.</div>
          </div>

          {/* Interactions */}
          <div style={{ gridColumn:"1/-1", background:"#f8fafc", border:"1px solid #e2e8f0", borderRadius:8, padding:16 }}>
            <div style={{ fontSize:11, fontWeight:700, color:"#64748b", marginBottom:10, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.08em" }}>INTERACTIONS</div>
            <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr 1fr", gap:10 }}>
              {[
                { action:"Click a task",       result:"Opens detail drawer with full context and escalation notes" },
                { action:"Click a lane name",   result:"Focuses that lane â€” dims all others for single-workstream view" },
                { action:"Click a dep chain",   result:"Highlights all tasks blocked by that dependency in indigo" },
                { action:"ðŸ”Š Play voiceover",   result:"Plays an executive audio briefing for that task" },
                { action:"Show All âœ•",          result:"Clears any active lane focus or dependency highlight" },
                { action:"Toggle D1 / TSA",     result:"Switches between Day-1 Readiness and TSA Exit views" },
              ].map(i => (
                <div key={i.action} style={{ fontSize:11, color:"#64748b" }}>
                  <div style={{ color:"#1e293b", fontWeight:600, marginBottom:2 }}>{i.action}</div>
                  {i.result}
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

// â”€â”€ Dep Chain Panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function DepPanel({ activeDep, setActiveDep, playClick }) {
  return (
    <div style={{ padding:"0 14px 14px" }}>
      <div style={{ fontSize:9, fontWeight:700, letterSpacing:"0.1em", textTransform:"uppercase", color:"#94a3b8", marginBottom:8 }}>Active Dependency Chains</div>
      {DEPENDENCY_CHAINS.map(d => {
        const isActive = activeDep === d.id;
        const urgColor = d.urgency === "red" ? "#dc2626" : "#ea580c";
        return (
          <div key={d.id}
            onClick={() => { setActiveDep(isActive ? null : d.id); playClick(); }}
            style={{
              marginBottom:6, borderRadius:6, padding:"8px 10px", cursor:"pointer",
              background: isActive ? (d.urgency==="red" ? "rgba(220,38,38,0.05)" : "rgba(234,88,12,0.05)") : "#f8fafc",
              border:`1px solid ${isActive ? urgColor+"40" : "#e2e8f0"}`,
              transition:"all 0.15s",
            }}>
            <div style={{ display:"flex", alignItems:"center", gap:6, marginBottom:3 }}>
              <div style={{ width:6, height:6, borderRadius:"50%", background:urgColor, flexShrink:0 }}/>
              <div style={{ fontSize:11, fontWeight:700, color: isActive ? urgColor : "#334155", lineHeight:1.3 }}>{d.title}</div>
            </div>
            <div style={{ fontSize:10, color:"#94a3b8", lineHeight:1.4, marginBottom:isActive?6:0 }}>{d.blocks.length} task{d.blocks.length>1?"s":""} blocked</div>
            {isActive && (
              <div>
                <div style={{ fontSize:10, color:"#64748b", lineHeight:1.5, marginBottom:6, paddingTop:6, borderTop:"1px solid #e2e8f0" }}>{d.blocker}</div>
                <div style={{ fontSize:9, color:"#94a3b8", fontWeight:700, marginBottom:3, fontFamily:"'IBM Plex Mono',monospace" }}>OWNER: {d.owner}</div>
                <div style={{ fontSize:9, color:"#94a3b8", fontWeight:700, marginBottom:4, fontFamily:"'IBM Plex Mono',monospace" }}>BLOCKS:</div>
                {d.blocks.map((b,i) => (
                  <div key={i} style={{ fontSize:10, color:"#64748b", paddingLeft:8, borderLeft:"2px solid #e2e8f0", marginBottom:2 }}>
                    {b.label}
                  </div>
                ))}
              </div>
            )}
          </div>
        );
      })}
    </div>
  );
}

// â”€â”€ App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App() {
  const [view, setView]           = useState("d1");
  const [selected, setSelected]   = useState(null);
  const [focusLane, setFocusLane] = useState(null);
  const [activeDep, setActiveDep] = useState(null);
  const [audioOn, setAudioOn]     = useState(true);
  const [sideTab, setSideTab]     = useState("lanes"); // "lanes" | "deps"
  const [showLegend, setShowLegend] = useState(false);
  const { playHover, playClick }  = useAudio(audioOn);
  const { speak, stop, speaking } = useSpeech(audioOn);

  const phases = view === "d1" ? PHASES_D1 : PHASES_TSA;
  const tasks  = view === "d1" ? TASKS_D1  : TASKS_TSA;

  // Count criticals
  const criticalCount = LANES.reduce((acc, lane) =>
    acc + Object.values(tasks[lane.id] || {}).flat().filter(t => t.status === "red").length, 0);

  // Determine if a task is highlighted by dep chain
  const isDepHighlighted = (laneId, taskLabel) => {
    if (!activeDep) return false;
    const chain = DEPENDENCY_CHAINS.find(d => d.id === activeDep);
    if (!chain) return false;
    return chain.blocks.some(b => b.lane === laneId && b.label === taskLabel);
  };

  const handleSelectTask = (taskObj, lane, phase, idx) => {
    playClick();
    const isSel = selected && selected.lane === lane && selected.phase === phase && selected.idx === idx;
    if (isSel) { setSelected(null); stop(); }
    else {
      setSelected({ lane, phase, idx, task: taskObj });
      if (taskObj.voiceover) speak(taskObj.voiceover);
      else stop();
    }
  };

  const T = {
    bg:"#f1f5f9", bgSidebar:"#ffffff", bgHeader:"#ffffff",
    bgGrid:"#ffffff", bgPhaseHdr:"#f8fafc", border:"#e2e8f0",
    text:"#1e293b", textMuted:"#64748b", textFaint:"#cbd5e1",
    rowAlt:"#f8fafc", laneLabel:"#f8fafc",
  };

  return (
    <div style={{ fontFamily:"'IBM Plex Sans',system-ui,sans-serif", background:T.bg, minHeight:"100vh", color:T.text }}>

      {showLegend && <LegendModal onClose={() => setShowLegend(false)} playClick={playClick} />}

      {/* â”€â”€ Header â”€â”€ */}
      <div style={{
        position:"sticky", top:0, zIndex:100,
        background:"#ffffff", borderBottom:`1px solid #e2e8f0`,
        boxShadow:"0 1px 4px rgba(0,0,0,0.06)",
        display:"flex", alignItems:"center", justifyContent:"space-between",
        padding:"0 20px", height:56,
      }}>
        <div style={{ display:"flex", alignItems:"center", gap:12 }}>
          <div style={{
            width:32, height:32, borderRadius:7,
            background:"linear-gradient(135deg,#7c3aed,#2563eb)",
            display:"flex", alignItems:"center", justifyContent:"center",
            fontSize:11, fontWeight:700, color:"white", fontFamily:"'IBM Plex Mono',monospace",
            letterSpacing:"0.05em",
          }}>PL</div>
          <div>
            <div style={{ fontSize:13, fontWeight:700, color:"#1e293b", fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.04em" }}>Project Liberty â€” Readiness Map</div>
            <div style={{ fontSize:10, color:"#94a3b8", fontFamily:"'IBM Plex Mono',monospace" }}>Veolia / Clean Earth Â· DB&T OCM Â· v3.1</div>
          </div>
        </div>
        <div style={{ display:"flex", alignItems:"center", gap:10 }}>
          {criticalCount > 0 && (
            <div style={{
              display:"flex", alignItems:"center", gap:6,
              background:"rgba(220,38,38,0.07)", border:"1px solid rgba(220,38,38,0.25)",
              borderRadius:5, padding:"4px 10px", fontSize:11, color:"#dc2626",
              fontFamily:"'IBM Plex Mono',monospace",
            }}>
              <span style={{ width:6, height:6, borderRadius:"50%", background:"#dc2626", display:"inline-block", animation:"pulse 1.5s ease-in-out infinite" }}/>
              {criticalCount} CRITICAL
            </div>
          )}
          {/* Legend button â€” prominent */}
          <button onClick={() => { setShowLegend(true); playClick(); }}
            title="Open legend and usage guide"
            style={{
              display:"flex", alignItems:"center", gap:7,
              background:"linear-gradient(135deg,#7c3aed,#6366f1)",
              border:"none", borderRadius:7, color:"#ffffff",
              fontSize:12, fontWeight:700, padding:"7px 14px", cursor:"pointer",
              fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.04em",
              boxShadow:"0 2px 8px rgba(99,102,241,0.35)",
              transition:"all 0.15s",
            }}
            onMouseEnter={e => { e.currentTarget.style.transform="translateY(-1px)"; e.currentTarget.style.boxShadow="0 4px 14px rgba(99,102,241,0.45)"; }}
            onMouseLeave={e => { e.currentTarget.style.transform="translateY(0)"; e.currentTarget.style.boxShadow="0 2px 8px rgba(99,102,241,0.35)"; }}>
            <span style={{fontSize:14}}>?</span> How to Use
          </button>
          {/* Audio toggle â€” prominent */}
          <button onClick={() => { if (audioOn) stop(); setAudioOn(!audioOn); }}
            title={audioOn ? "Mute audio and voiceovers" : "Enable audio and voiceovers"}
            style={{
              display:"flex", alignItems:"center", gap:6,
              padding:"7px 13px", borderRadius:7, cursor:"pointer",
              border: audioOn ? "none" : "1px solid #e2e8f0",
              background: audioOn ? "linear-gradient(135deg,#0891b2,#0284c7)" : "#f8fafc",
              color: audioOn ? "#ffffff" : "#94a3b8",
              fontSize:12, fontWeight:700, fontFamily:"'IBM Plex Mono',monospace",
              boxShadow: audioOn ? "0 2px 8px rgba(8,145,178,0.35)" : "none",
              transition:"all 0.15s",
            }}
            onMouseEnter={e => { if (audioOn) { e.currentTarget.style.transform="translateY(-1px)"; e.currentTarget.style.boxShadow="0 4px 12px rgba(8,145,178,0.45)"; } }}
            onMouseLeave={e => { e.currentTarget.style.transform="translateY(0)"; e.currentTarget.style.boxShadow = audioOn ? "0 2px 8px rgba(8,145,178,0.35)" : "none"; }}>
            <span style={{fontSize:14}}>{audioOn ? "ðŸ”Š" : "ðŸ”‡"}</span>
            {audioOn ? "Audio On" : "Audio Off"}
          </button>
        </div>
      </div>

      <div style={{ display:"flex", alignItems:"flex-start" }}>

        {/* â”€â”€ Sidebar â”€â”€ */}
        <div style={{
          width:196, flexShrink:0, background:"#ffffff",
          borderRight:`1px solid #e2e8f0`,
          position:"sticky", top:56,
          height:"calc(100vh - 56px)", overflowY:"auto",
          display:"flex", flexDirection:"column",
          boxShadow:"1px 0 8px rgba(0,0,0,0.04)",
        }}>
          {/* Sidebar tab switcher */}
          <div style={{ display:"flex", borderBottom:`1px solid #e2e8f0`, flexShrink:0 }}>
            {[{id:"lanes",label:"Swimlanes"},{id:"deps",label:"Dependencies"}].map(t => (
              <button key={t.id} onClick={() => { setSideTab(t.id); playClick(); }}
                onMouseEnter={e => { e.currentTarget.style.fontSize="11px"; e.currentTarget.style.color = sideTab===t.id ? "#1e293b" : "#475569"; }}
                onMouseLeave={e => { e.currentTarget.style.fontSize="10px"; }}
                style={{
                  flex:1, padding:"9px 0", fontSize:"10px", fontWeight:700,
                  fontFamily:"'IBM Plex Mono',monospace", letterSpacing:"0.06em",
                  textTransform:"uppercase", cursor:"pointer", border:"none",
                  background: sideTab === t.id ? "#ffffff" : "#f8fafc",
                  color: sideTab === t.id ? "#1e293b" : "#94a3b8",
                  borderBottom: sideTab === t.id ? "2px solid #6366f1" : "2px solid transparent",
                  transition:"font-size 0.15s ease, color 0.15s ease",
                }}>{t.label}</button>
            ))}
          </div>

          <div style={{ overflowY:"auto", flex:1, paddingTop:14 }}>
            {sideTab === "lanes" ? (
              <div style={{ padding:"0 14px 14px" }}>
                <div style={{ display:"flex", alignItems:"center", justifyContent:"space-between", marginBottom:8 }}>
                  <div style={{ fontSize:9, fontWeight:700, letterSpacing:"0.1em", textTransform:"uppercase", color:"#94a3b8" }}>Lanes</div>
                  {focusLane && (
                    <div onClick={() => { setFocusLane(null); playClick(); }}
                      style={{ fontSize:10, fontWeight:600, color:"#6366f1", cursor:"pointer",
                        background:"rgba(99,102,241,0.07)", border:"1px solid rgba(99,102,241,0.2)",
                        borderRadius:4, padding:"2px 7px" }}>
                      Show All âœ•
                    </div>
                  )}
                </div>
                {LANES.map(lane => (
                  <div key={lane.id}
                    onClick={() => { setFocusLane(focusLane === lane.id ? null : lane.id); playClick(); }}
                    onMouseEnter={() => playHover()}
                    style={{
                      display:"flex", alignItems:"center", gap:8, padding:"5px 8px",
                      borderRadius:5, cursor:"pointer", marginBottom:2,
                      background: focusLane === lane.id ? "rgba(99,102,241,0.06)" : "transparent",
                      border: focusLane === lane.id ? "1px solid rgba(99,102,241,0.15)" : "1px solid transparent",
                      opacity: focusLane && focusLane !== lane.id ? 0.35 : 1,
                      transition:"all 0.15s",
                    }}>
                    <div style={{ width:7, height:7, borderRadius:2, background:lane.accent, flexShrink:0 }}/>
                    <span style={{ fontSize:12, color:"#334155", fontWeight: focusLane === lane.id ? 700 : 400 }}>{lane.label}</span>
                  </div>
                ))}
                <div style={{ height:1, background:"#e2e8f0", margin:"12px 0" }}/>
                <div style={{ fontSize:9, fontWeight:700, letterSpacing:"0.1em", textTransform:"uppercase", color:"#94a3b8", marginBottom:8 }}>Status</div>
                {Object.entries(STATUS).map(([k,v]) => (
                  <div key={k} style={{ display:"flex", alignItems:"center", gap:7, marginBottom:5 }}>
                    <div style={{ width:7, height:7, borderRadius:2, background:v.dot, flexShrink:0 }}/>
                    <span style={{ fontSize:11, color:"#334155" }}>{v.label}</span>
                  </div>
                ))}
                <div style={{ height:1, background:"#e2e8f0", margin:"12px 0" }}/>
                <div style={{ fontSize:9, fontWeight:700, letterSpacing:"0.1em", textTransform:"uppercase", color:"#94a3b8", marginBottom:8 }}>Key Dates</div>
                {(view === "d1" ? [
                  {code:"NOW", val:"Feb 18, 2026", c:"#2563eb"},
                  {code:"MOB", val:"Mar 1â€“31",     c:"#7c3aed"},
                  {code:"RDY", val:"Apr 1â€“30",     c:"#b45309"},
                  {code:"D-1", val:"May 1, 2026",  c:"#dc2626"},
                ] : [
                  {code:"Mo1", val:"Post-close stabilize", c:"#059669"},
                  {code:"Mo2", val:"Core enablement",      c:"#0891b2"},
                  {code:"Mo4", val:"Migration prep",       c:"#2563eb"},
                  {code:"Mo6", val:"TSA Exit âœ“",           c:"#047857"},
                ]).map(d => (
                  <div key={d.code} style={{ display:"flex", gap:8, alignItems:"baseline", marginBottom:5 }}>
                    <span style={{ fontSize:10, fontFamily:"'IBM Plex Mono',monospace", fontWeight:700, color:d.c, minWidth:28 }}>{d.code}</span>
                    <span style={{ fontSize:11, color:"#334155" }}>{d.val}</span>
                  </div>
                ))}
              </div>
            ) : (
              <DepPanel activeDep={activeDep} setActiveDep={setActiveDep} playClick={playClick} />
            )}
          </div>
        </div>

        {/* â”€â”€ Grid â”€â”€ */}
        <div style={{ flex:1, minWidth:0 }}>

          {/* View Toggle */}
          <div style={{
            position:"sticky", top:56, zIndex:51,
            background:"#ffffff", borderBottom:`1px solid #e2e8f0`,
            boxShadow:"0 1px 3px rgba(0,0,0,0.04)",
            display:"flex", alignItems:"center", justifyContent:"center",
            padding:"8px 24px", gap:4,
          }}>
            {[
              {id:"d1",  label:"âš¡ Day-1 Readiness", sub:"Now â†’ May 1, 2026",  activeColor:"#2563eb"},
              {id:"tsa", label:"ðŸ“‹ TSA Exit Plan",    sub:"May â†’ October 2026", activeColor:"#059669"},
            ].map(t => (
              <button key={t.id}
                onClick={() => { setView(t.id); setSelected(null); stop(); setFocusLane(null); setActiveDep(null); playClick(); }}
                onMouseEnter={() => playHover()}
                style={{
                  padding:"6px 28px", borderRadius:6, border:"none", cursor:"pointer",
                  fontFamily:"inherit", textAlign:"center",
                  background: view === t.id ? "#f8fafc" : "transparent",
                  borderBottom: view === t.id ? `2px solid ${t.activeColor}` : "2px solid transparent",
                  transition:"all 0.15s",
                }}>
                <div style={{ fontSize:12, fontWeight:700, color: view === t.id ? t.activeColor : "#94a3b8" }}>{t.label}</div>
                <div style={{ fontSize:10, color: view === t.id ? "#64748b" : "#cbd5e1", marginTop:1, fontFamily:"'IBM Plex Mono',monospace" }}>{t.sub}</div>
              </button>
            ))}
          </div>

          <div style={{ minWidth:800 }}>

            {/* Phase header row with gate arrows */}
            <div style={{
              display:"grid", gridTemplateColumns:`160px repeat(${phases.length}, 1fr)`,
              borderBottom:`1px solid #e2e8f0`,
              background:"#f8fafc", position:"sticky", top:112, zIndex:50,
              boxShadow:"0 1px 3px rgba(0,0,0,0.04)",
            }}>
              <div style={{ borderRight:`1px solid #e2e8f0` }}/>
              {phases.map((p,i) => (
                <div key={p.id} style={{ position:"relative" }}>
                  <div style={{
                    padding:"10px 14px",
                    borderRight: i < phases.length-1 ? `1px solid #e2e8f0` : "none",
                    borderTop:`2px solid ${p.accent}`,
                    background:`linear-gradient(180deg,${p.accent}0d 0%,transparent 100%)`,
                  }}>
                    <div style={{ fontSize:12, fontWeight:700, color:p.accent, fontFamily:"'IBM Plex Mono',monospace" }}>{p.label}</div>
                    <div style={{ fontSize:10, color:"#94a3b8", marginTop:2, fontFamily:"'IBM Plex Mono',monospace" }}>{p.dates}</div>
                  </div>
                  {/* Phase gate arrow */}
                  {p.arrow && i < phases.length-1 && (
                    <div title={p.arrow} style={{
                      position:"absolute", right:-12, top:"50%", transform:"translateY(-50%)",
                      zIndex:10, cursor:"help",
                    }}>
                      <div style={{
                        width:22, height:22, borderRadius:"50%",
                        background:"#ffffff", border:"1px solid #e2e8f0",
                        display:"flex", alignItems:"center", justifyContent:"center",
                        fontSize:11, color:"#94a3b8",
                        transition:"all 0.15s",
                        boxShadow:"0 1px 4px rgba(0,0,0,0.08)",
                      }}
                        onMouseEnter={e => {
                          e.currentTarget.style.background = "#f0f0ff";
                          e.currentTarget.style.color = "#6366f1";
                          e.currentTarget.style.borderColor = "#a5b4fc";
                          e.currentTarget.style.boxShadow = "0 2px 8px rgba(99,102,241,0.2)";
                        }}
                        onMouseLeave={e => {
                          e.currentTarget.style.background = "#ffffff";
                          e.currentTarget.style.color = "#94a3b8";
                          e.currentTarget.style.borderColor = "#e2e8f0";
                          e.currentTarget.style.boxShadow = "0 1px 4px rgba(0,0,0,0.08)";
                        }}>â€º</div>
                    </div>
                  )}
                </div>
              ))}
            </div>

            {/* Lane rows */}
            {LANES.map((lane,li) => (
              <div key={lane.id} style={{
                display:"grid", gridTemplateColumns:`160px repeat(${phases.length}, 1fr)`,
                borderBottom:`1px solid #e2e8f0`,
                background: li % 2 === 0 ? "#ffffff" : "#fafbfc",
                opacity: !focusLane || focusLane === lane.id ? 1 : 0.12,
                transition:"opacity 0.2s",
              }}>
                {/* Lane label */}
                <div onClick={() => { setFocusLane(focusLane === lane.id ? null : lane.id); playClick(); }}
                  onMouseEnter={() => playHover()}
                  style={{
                    display:"flex", alignItems:"flex-start", gap:8, padding:"12px 10px",
                    borderRight:`1px solid #e2e8f0`, cursor:"pointer",
                    background:"#f8fafc", position:"sticky", left:0, zIndex:10,
                    boxShadow:"1px 0 4px rgba(0,0,0,0.06)",
                  }}>
                  <div style={{ width:2, height:24, borderRadius:1, background:lane.accent, flexShrink:0, marginTop:2 }}/>
                  <div style={{ fontSize:12, fontWeight:700, color:lane.accent, lineHeight:1.4 }}>{lane.label}</div>
                </div>

                {/* Phase cells */}
                {phases.map((p,pi) => {
                  const cellTasks = tasks[lane.id]?.[p.id] || [];
                  return (
                    <div key={p.id} style={{
                      padding:"8px", minHeight:76,
                      borderRight: pi < phases.length-1 ? `1px solid #e2e8f0` : "none",
                      display:"flex", flexDirection:"column", gap:4,
                    }}>
                      {cellTasks.map((task,ti) => {
                        const s = STATUS[task.status];
                        const tt = TASK_TYPES[task.type || "standard"];
                        const isSel = selected && selected.lane === lane.id && selected.phase === p.id && selected.idx === ti;
                        const isDepHL = isDepHighlighted(lane.id, task.label);
                        const hasVO = !!task.voiceover;
                        const isBlocked = task.type === "blocked";

                        return (
                          <div key={ti}
                            onClick={() => handleSelectTask(task, lane.id, p.id, ti)}
                            onMouseEnter={e => {
                              playHover();
                              e.currentTarget.style.borderColor = s.border;
                              e.currentTarget.style.background = s.bg;
                              e.currentTarget.style.transform = "translateY(-1px)";
                              e.currentTarget.style.boxShadow = "0 2px 8px rgba(0,0,0,0.08)";
                            }}
                            onMouseLeave={e => {
                              if (!isSel && !isDepHL) {
                                e.currentTarget.style.borderColor = isBlocked ? "rgba(220,38,38,0.2)" : "#e2e8f0";
                                e.currentTarget.style.background = isBlocked ? "rgba(220,38,38,0.03)" : "transparent";
                                e.currentTarget.style.transform = "translateY(0)";
                                e.currentTarget.style.boxShadow = "none";
                              }
                            }}
                            style={{
                              background: isSel ? s.bg : isDepHL ? "rgba(99,102,241,0.07)" : isBlocked ? "rgba(220,38,38,0.03)" : "transparent",
                              border:`1px solid ${isSel ? s.border : isDepHL ? "rgba(99,102,241,0.35)" : isBlocked ? "rgba(220,38,38,0.2)" : "#e2e8f0"}`,
                              borderRadius:4, padding:"4px 8px",
                              fontSize:11, color: isSel ? s.text : isDepHL ? "#6366f1" : "#1e293b",
                              cursor:"pointer", transition:"all 0.12s", lineHeight:1.4,
                              boxShadow: isSel ? "0 2px 8px rgba(0,0,0,0.08)" : "none",
                              display:"flex", alignItems:"flex-start", justifyContent:"space-between", gap:4,
                            }}>
                            <div style={{ display:"flex", alignItems:"baseline", gap:4, flex:1, minWidth:0 }}>
                              {tt.icon && (
                                <span title={tt.label + ": " + tt.desc} style={{ fontSize:10, flexShrink:0, opacity:0.55 }}>{tt.icon}</span>
                              )}
                              <span style={{ fontSize:11, lineHeight:1.4 }}>{task.label}</span>
                            </div>
                            <div style={{ display:"flex", alignItems:"center", gap:3, flexShrink:0 }}>
                              {hasVO && audioOn && <span title="Voiceover available" style={{ fontSize:9, opacity:0.35 }}>ðŸ”Š</span>}
                              <div style={{ width:5, height:5, borderRadius:"50%", background:s.dot, flexShrink:0, marginTop:2 }}/>
                            </div>
                          </div>
                        );
                      })}
                      {cellTasks.length === 0 && (
                        <div style={{ fontSize:10, color:"#e2e8f0", paddingTop:4 }}>â€”</div>
                      )}
                    </div>
                  );
                })}
              </div>
            ))}

          </div>
        </div>
      </div>

      {/* â”€â”€ Detail Drawer â”€â”€ */}
      {selected && (
        <div style={{
          position:"fixed", bottom:0, left:196, right:0, zIndex:200,
          background:"#ffffff", borderTop:`2px solid ${STATUS[selected.task.status].border}`,
          padding:"14px 24px", display:"flex", alignItems:"flex-start", gap:16,
          boxShadow:"0 -8px 32px rgba(0,0,0,0.1)",
          animation:"drawerPopUp 0.22s cubic-bezier(0.34,1.56,0.64,1) both",
        }}>
          <div style={{ flex:1 }}>
            <div style={{ display:"flex", alignItems:"center", gap:10, marginBottom:6, flexWrap:"wrap" }}>
              {/* Status badge */}
              <div style={{
                fontSize:9, fontWeight:700, padding:"2px 7px", borderRadius:3,
                textTransform:"uppercase", letterSpacing:"0.08em", fontFamily:"'IBM Plex Mono',monospace",
                background:STATUS[selected.task.status].bg,
                border:`1px solid ${STATUS[selected.task.status].border}`,
                color:STATUS[selected.task.status].text,
              }}>{STATUS[selected.task.status].label}</div>

              {/* Task type badge */}
              {selected.task.type && selected.task.type !== "standard" && (
                <div style={{
                  fontSize:9, fontWeight:700, padding:"2px 7px", borderRadius:3,
                  textTransform:"uppercase", letterSpacing:"0.08em", fontFamily:"'IBM Plex Mono',monospace",
                  background:"rgba(99,102,241,0.07)", border:"1px solid rgba(99,102,241,0.2)", color:"#6366f1",
                }}>
                  {TASK_TYPES[selected.task.type]?.icon} {TASK_TYPES[selected.task.type]?.label}
                </div>
              )}

              <div style={{ fontSize:15, fontWeight:700, color:"#1e293b" }}>{selected.task.label}</div>

              {/* Dep chain badge */}
              {selected.task.depChain && (
                <div onClick={() => { setSideTab("deps"); setActiveDep(selected.task.depChain); playClick(); }}
                  style={{
                    fontSize:9, fontWeight:700, padding:"2px 7px", borderRadius:3, cursor:"pointer",
                    textTransform:"uppercase", letterSpacing:"0.08em", fontFamily:"'IBM Plex Mono',monospace",
                    background:"rgba(220,38,38,0.06)", border:"1px solid rgba(220,38,38,0.2)", color:"#dc2626",
                  }}>
                  â›“ View Dependency Chain â†’
                </div>
              )}

              {/* Voiceover */}
              {selected.task.voiceover && audioOn && (
                <div style={{ display:"flex", alignItems:"center", gap:5,
                  fontSize:10, color: speaking ? "#2563eb" : "#94a3b8",
                  background: speaking ? "rgba(37,99,235,0.06)" : "#f8fafc",
                  border:`1px solid ${speaking ? "rgba(37,99,235,0.2)" : "#e2e8f0"}`,
                  borderRadius:4, padding:"2px 8px", fontFamily:"'IBM Plex Mono',monospace" }}>
                  <span>{speaking ? "â–¶" : "ðŸ”Š"}</span>
                  {speaking ? (
                    <span onClick={stop} style={{ cursor:"pointer", color:"#dc2626", fontWeight:700 }}>â–  Stop</span>
                  ) : (
                    <span onClick={() => speak(selected.task.voiceover)} style={{ cursor:"pointer", color:"#2563eb", fontWeight:700 }}>â–¶ Play</span>
                  )}
                </div>
              )}
            </div>
            <div style={{ fontSize:13, color:"#475569", lineHeight:1.7 }}>{selected.task.detail}</div>
          </div>
          <button onClick={() => { setSelected(null); stop(); playClick(); }}
            style={{ background:"#f1f5f9", border:`1px solid #e2e8f0`, borderRadius:5,
              color:"#64748b", fontSize:11, padding:"4px 10px", cursor:"pointer",
              fontFamily:"'IBM Plex Mono',monospace", flexShrink:0 }}>
            Close âœ•
          </button>
        </div>
      )}

      <style>{`
        @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
        @keyframes drawerPopUp {
          0%   { transform: translateY(100%); opacity: 0; }
          100% { transform: translateY(0);    opacity: 1; }
        }
      `}</style>

    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
